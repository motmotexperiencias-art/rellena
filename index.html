<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReLlenas - Barichara</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #ffffff; /* BLANCO PURO */
            color: #1a1a1a;
            padding-bottom: 200px;
        }

        /* COLORES DE MARCA */
        :root {
            --brand-yellow: #FFC300; 
            --brand-red: #D32F2F;    
            --brand-black: #111111;
        }

        .text-yellow-brand { color: var(--brand-yellow); }
        .text-red-brand { color: var(--brand-red); }
        .bg-red-brand { background-color: var(--brand-red); }

        /* HEADER */
        header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        /* TARJETAS DE INGREDIENTES */
        .card-ingredient {
            background-color: #ffffff; /* Blanco */
            border: 1px solid #e5e7eb; /* Gris muy suave */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease-in-out;
        }

        .card-ingredient:hover {
            border-color: #d1d5db;
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }

        .card-ingredient.selected {
            background-color: #fffbeb; /* Amarillo muy suave casi blanco */
            border: 2px solid var(--brand-black);
            transform: translate(-1px, -1px);
            box-shadow: 4px 4px 0px var(--brand-black); /* Efecto Pop Art */
        }
        
        .card-ingredient.selected .check-indicator {
            background-color: var(--brand-red);
            color: white;
            border-color: var(--brand-red);
        }

        .check-indicator {
            background-color: #f3f4f6;
            color: transparent;
            border: 1px solid #d1d5db;
        }

        /* INPUTS */
        .input-light {
            background-color: #ffffff;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
            color: #000;
        }
        .input-light:focus {
            background-color: #ffffff;
            border-color: var(--brand-red);
            outline: none;
            box-shadow: 0 0 0 4px rgba(211, 47, 47, 0.05);
        }

        /* BOTONES */
        .btn-add-next {
            background-color: var(--brand-black);
            color: var(--brand-yellow);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        
        .btn-finish {
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            color: white;
            box-shadow: 0 8px 25px rgba(211, 47, 47, 0.3);
        }
        .btn:active { transform: scale(0.98); }

        /* MEDIOS DE PAGO */
        .payment-option {
            border: 1px solid #e5e7eb;
            background-color: #ffffff;
            transition: all 0.2s;
        }
        .payment-option.selected {
            border-color: var(--brand-red);
            background-color: #fef2f2; /* Rojo muy p치lido */
            color: var(--brand-red);
            font-weight: 800;
            box-shadow: 0 0 0 1px var(--brand-red);
        }

        /* ANIMACIONES */
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-down {
            animation: slideDown 0.3s ease-out;
        }

        /* Resumen Flotante */
        .cart-summary-item {
            background-color: #f9fafb; /* Gris casi blanco */
            border: 1px solid #f3f4f6;
            border-left: 4px solid var(--brand-red);
        }
        
        /* Footer */
        footer {
            background-color: #ffffff;
            border-top: 1px solid #f3f4f6;
        }
    </style>
</head>
<body>

    <!-- Header Sticky -->
    <header class="fixed top-0 w-full z-50 border-b border-gray-100 p-4 shadow-sm">
        <div class="flex justify-between items-center max-w-md mx-auto">
            <div class="flex flex-col leading-none">
                <h1 class="text-3xl font-black italic tracking-tighter text-black">
                    Re<span class="text-yellow-brand">Llenas</span>
                </h1>
                <div class="flex items-center gap-1 mt-1">
                    <i data-lucide="map-pin" class="w-3 h-3 text-red-brand"></i>
                    <span class="text-[10px] text-gray-500 font-bold uppercase tracking-widest">Barichara</span>
                </div>
            </div>
            <div class="text-right">
                <div class="bg-red-brand text-white text-[10px] font-bold px-2 py-0.5 rounded-sm inline-block mb-1 transform -rotate-2">PRECIO 칔NICO</div>
                <div class="text-2xl font-black text-black leading-none">$5.000</div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-md mx-auto pt-28 px-4">

        <!-- Info Domicilio -->
        <section class="mb-6 bg-yellow-50 p-4 rounded-xl border border-yellow-200">
            <div class="flex items-start gap-3">
                <div class="bg-yellow-400 p-2 rounded-full text-black shadow-sm">
                    <i data-lucide="bike" class="w-5 h-5"></i>
                </div>
                <div>
                    <h3 class="text-sm font-bold text-black uppercase">Domicilio: $4.000</h3>
                    <p class="text-xs text-gray-600 leading-tight mt-1">
                        Tarifa 칰nica por todo el pedido (Casco urbano).
                    </p>
                </div>
            </div>
        </section>

        <!-- Formulario Datos -->
        <section class="mb-8">
            <div class="grid gap-4">
                <div>
                    <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block">Tu Nombre</label>
                    <input type="text" id="clientName" placeholder="Ej: Juan P칠rez" class="input-light w-full rounded-lg p-3 font-bold text-black">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block">Direcci칩n de Entrega</label>
                    <input type="text" id="clientAddress" placeholder="Ej: Barrio La Loma, Casa 4" class="input-light w-full rounded-lg p-3 font-bold text-black">
                </div>
            </div>
        </section>

        <!-- ZONA DE CANASTA (Aparece al agregar) -->
        <section id="mini-cart" class="hidden mb-8 animate-slide-down">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                <i data-lucide="shopping-bag" class="w-4 h-4 text-red-600"></i> Tu Pedido Actual:
            </h3>
            <div id="mini-cart-items" class="space-y-3">
                <!-- Items agregados aqu칤 -->
            </div>
        </section>

        <!-- Aviso Relleno -->
        <div class="bg-white border border-gray-200 p-3 rounded-lg mb-6 text-center shadow-sm">
            <p class="text-xs text-gray-500 font-medium">
                <i data-lucide="info" class="w-3 h-3 inline mr-1 text-yellow-500"></i>
                Tenemos empanadas con relleno salado y con relleno dulce, rellenalas a tu antojo. Pudes seleccionar los ingredientes que quieras, el relleno se divide equitativamente en tu empanada.
            </p>
        </div>

        <!-- CONSTRUCTOR DE EMPANADA -->
        <div id="builder-zone" class="bg-white rounded-xl">
            
            <!-- T칤tulo Din치mico -->
            <div class="flex items-center justify-between mb-6 sticky top-[85px] z-40 bg-white/95 backdrop-blur py-4 border-b border-gray-100">
                <h2 class="text-lg font-black text-red-700 uppercase flex items-center gap-2">
                    <span class="bg-red-700 text-white w-7 h-7 flex items-center justify-center rounded-full text-sm shadow-md" id="empanada-number">1</span>
                    Armando Empanada
                </h2>
                <button onclick="resetBuilder()" class="text-[10px] text-gray-400 hover:text-red-500 font-bold uppercase tracking-wider bg-gray-50 px-2 py-1 rounded">Borrar Selecci칩n</button>
            </div>

            <!-- SABORES SALADOS -->
            <section class="mb-10">
                <h3 class="text-xs font-black text-gray-400 mb-4 uppercase tracking-widest pl-1 border-l-4 border-yellow-400 ml-1"> Mundo Sal</h3>
                <div id="content-sal" class="grid grid-cols-2 gap-3"></div>
            </section>

            <!-- SABORES DULCES -->
            <section class="mb-10">
                <h3 class="text-xs font-black text-gray-400 mb-4 uppercase tracking-widest pl-1 border-l-4 border-yellow-400 ml-1"> Mundo Dulce</h3>
                <div id="content-dulce" class="grid grid-cols-2 gap-3"></div>
            </section>

            <!-- QUESOS -->
            <section class="mb-10 bg-yellow-50/30 p-4 rounded-xl border border-yellow-100">
                <h3 class="text-xs font-black text-yellow-700 mb-3 uppercase flex items-center gap-2">
                    <i data-lucide="cheese" class="w-4 h-4"></i>
                    쯃e ponemos Queso?
                </h3>
                <div id="content-quesos" class="grid grid-cols-1 gap-2"></div>
            </section>

            <!-- BOT칍N AGREGAR Y SEGUIR -->
            <div class="sticky bottom-24 bg-white pt-2 pb-4 z-30"> <!-- Bot칩n medio flotante -->
                <button onclick="addEmpanadaAndReset()" class="btn-add-next w-full py-4 rounded-xl font-black text-lg flex items-center justify-center gap-2 uppercase tracking-wide transform active:scale-95 transition-all shadow-xl">
                    <i data-lucide="plus-circle" class="w-6 h-6 text-yellow-400"></i>
                    Agregar y Armar Otra
                </button>
                <p class="text-center text-[10px] text-gray-400 mt-2 uppercase tracking-wide">Esta empanada se guardar치 arriba</p>
            </div>

        </div>

        <!-- MEDIOS DE PAGO -->
        <section id="payment-section" class="mb-8 hidden border-t border-dashed border-gray-200 pt-8 mt-8">
            <h3 class="text-xs font-black text-black mb-4 uppercase tracking-widest text-center">Selecciona Medio de Pago</h3>
            <div class="grid grid-cols-2 gap-3">
                <div onclick="selectPayment('Nequi', this)" class="payment-option p-4 rounded-xl text-center cursor-pointer text-xs font-bold text-gray-600 select-none hover:bg-gray-50">Nequi</div>
                <div onclick="selectPayment('Daviplata', this)" class="payment-option p-4 rounded-xl text-center cursor-pointer text-xs font-bold text-gray-600 select-none hover:bg-gray-50">Daviplata</div>
                <div onclick="selectPayment('Efectivo', this)" class="payment-option p-4 rounded-xl text-center cursor-pointer text-xs font-bold text-gray-600 select-none hover:bg-gray-50">Efectivo</div>
                <div onclick="selectPayment('Tarjeta', this)" class="payment-option p-4 rounded-xl text-center cursor-pointer text-xs font-bold text-gray-600 select-none hover:bg-gray-50">Tarjeta</div>
            </div>
        </section>

    </main>

    <!-- Footer Sticky -->
    <footer class="fixed bottom-0 w-full z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.05)]">
        <div class="max-w-md mx-auto bg-white p-4 pb-6">
            <div class="flex justify-between items-end mb-4 text-xs border-b border-gray-100 pb-3">
                <div class="text-gray-500 space-y-1">
                    <p>Empanadas (<span id="count-footer" class="font-bold text-black">0</span>): <span class="font-bold text-black" id="subtotal-footer">$0</span></p>
                    <p>Domicilio: <span class="font-bold text-black">$4.000</span></p>
                </div>
                <div class="text-right">
                    <p class="text-[10px] text-gray-400 uppercase tracking-wider mb-1">Total a Pagar</p>
                    <p class="font-black text-3xl text-black leading-none" id="total-footer">$4.000</p>
                </div>
            </div>

            <button onclick="finishOrder()" class="btn-finish w-full py-4 rounded-xl font-black text-xl flex items-center justify-center gap-3 uppercase tracking-wider transition-transform active:scale-95">
                <span>ENVIAR PEDIDO</span>
                <i data-lucide="message-circle" class="w-6 h-6"></i>
            </button>
        </div>
    </footer>

    <script>
        // --- CONFIGURACI칍N DEL MEN칔 ---
        const salados = [
            { name: 'Chorizo con Hogao', desc: 'Sabor criollo intenso' },
            { name: 'Carne Molida', desc: 'Con chimichurri de la casa' },
            { name: 'Pollo Desmechado', desc: 'En mayonesa y cilantro' },
            { name: 'Papa con Huevo', desc: 'La cl치sica infaltable' },
            { name: 'Salchicha', desc: 'Ranchera picadita' },
            { name: 'Arroz con Cilantro', desc: 'Base suave y arom치tica' }
        ];

        const dulces = [
            { name: 'Arequipe', desc: 'Dulce de leche tradicional' },
            { name: 'Nutella', desc: 'Crema de avellanas' },
            { name: 'Chocolatina', desc: 'Trozos de chocolate' },
            { name: 'Crema Chantilly', desc: 'Suave y dulce' },
            { name: 'Pi침a en Alm칤bar', desc: 'Dulce frutal' }
        ];

        const quesos = [
            { name: 'Queso Crema', desc: 'Suave y untable' },
            { name: 'Queso Doble Crema', desc: 'Para fundir (El chicle)' },
            { name: 'Queso Coste침o', desc: 'Saladito y duro' }
        ];

        // --- ESTADO ---
        let cart = []; // Array de empanadas
        let currentIngredients = []; // Ingredientes de la empanada actual
        let selectedPayment = null;

        // --- RENDERIZADO ---
        function renderGrid(items, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card-ingredient p-4 rounded-xl cursor-pointer group flex flex-col justify-between h-24 select-none';
                card.onclick = () => toggleItem(item.name, card);
                
                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h4 class="font-bold text-black text-sm leading-tight group-hover:text-red-700 transition-colors">${item.name}</h4>
                        <div class="check-indicator w-6 h-6 rounded-full flex items-center justify-center border transition-all">
                            <i data-lucide="check" class="w-3 h-3 font-bold"></i>
                        </div>
                    </div>
                    <p class="text-[10px] text-gray-400 mt-auto uppercase tracking-wide font-medium">${item.desc}</p>
                `;
                container.appendChild(card);
            });
        }

        // --- L칍GICA DE SELECCI칍N ---
        function toggleItem(name, element) {
            if (currentIngredients.includes(name)) {
                currentIngredients = currentIngredients.filter(i => i !== name);
                element.classList.remove('selected');
            } else {
                currentIngredients.push(name);
                element.classList.add('selected');
            }
        }

        function selectPayment(method, element) {
            selectedPayment = method;
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
        }

        // --- AGREGAR EMPANADA AL CARRITO ---
        function addEmpanadaAndReset() {
            // Validaci칩n: No vac칤a sin confirmaci칩n
            if (currentIngredients.length === 0) {
                if(!confirm("쯉eguro quieres agregar una empanada VAC칈A (Solo Masa)?")) return;
            }

            // 1. Guardar en el carrito
            cart.push([...currentIngredients]);

            // 2. Actualizar UI del Carrito (Parte Superior)
            const cartContainer = document.getElementById('mini-cart');
            const cartItems = document.getElementById('mini-cart-items');
            
            cartContainer.classList.remove('hidden');
            
            // Crear el elemento visual de la empanada
            const newItem = document.createElement('div');
            // Usamos un ID 칰nico temporal basado en el 칤ndice
            const index = cart.length - 1;
            newItem.id = `cart-item-${index}`;
            newItem.className = "cart-summary-item flex justify-between items-center p-3 rounded-lg shadow-sm animate-slide-down";
            newItem.innerHTML = `
                <div>
                    <span class="text-red-700 font-black text-sm mr-2 bg-white px-2 py-0.5 rounded border border-gray-200">#${cart.length}</span> 
                    <span class="text-gray-800 text-sm font-bold">${currentIngredients.length > 0 ? currentIngredients.join(', ') : 'Solo Masa'}</span>
                </div>
                <button onclick="removeEmpanada(${index})" class="text-gray-400 hover:text-red-500 p-2 rounded-full hover:bg-white transition-colors">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
            `;
            // Insertar al inicio para que la m치s reciente se vea primero
            cartItems.insertBefore(newItem, cartItems.firstChild);

            // 3. Mostrar secci칩n de pago si es la primera
            if (cart.length === 1) {
                document.getElementById('payment-section').classList.remove('hidden');
            }

            // 4. Actualizar footer
            updateFooter();

            // 5. LIMPIEZA Y PREPARACI칍N PARA LA SIGUIENTE
            currentIngredients = [];
            document.querySelectorAll('.card-ingredient').forEach(el => el.classList.remove('selected'));
            
            // Actualizar n칰mero en el t칤tulo
            document.getElementById('empanada-number').innerText = cart.length + 1;

            // Scroll suave hacia arriba para que el usuario sepa que empez칩 de nuevo
            setTimeout(() => {
                const builderZone = document.getElementById('builder-zone');
                // Calcular posici칩n con offset para el header sticky
                const y = builderZone.getBoundingClientRect().top + window.scrollY - 140; 
                window.scrollTo({top: y, behavior: 'smooth'});
            }, 100);
            
            // Re-inicializar iconos para el nuevo elemento del carrito
            lucide.createIcons();
        }

        function removeEmpanada(index) {
            // Nota: En un sistema simple como este, al borrar un 칤ndice,
            // los 칤ndices siguientes se desplazan. Para evitar problemas visuales r치pidos,
            // recargamos toda la lista.
            
            cart.splice(index, 1);
            
            // Repintar lista visual completa
            const cartItems = document.getElementById('mini-cart-items');
            cartItems.innerHTML = '';
            
            cart.forEach((ingredients, i) => {
                const newItem = document.createElement('div');
                newItem.id = `cart-item-${i}`;
                newItem.className = "cart-summary-item flex justify-between items-center p-3 rounded-lg shadow-sm mb-2";
                newItem.innerHTML = `
                    <div>
                        <span class="text-red-700 font-black text-sm mr-2 bg-white px-2 py-0.5 rounded border border-gray-200">#${i + 1}</span> 
                        <span class="text-gray-800 text-sm font-bold">${ingredients.length > 0 ? ingredients.join(', ') : 'Solo Masa'}</span>
                    </div>
                    <button onclick="removeEmpanada(${i})" class="text-gray-400 hover:text-red-500 p-2 rounded-full hover:bg-white transition-colors">
                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                    </button>
                `;
                cartItems.insertBefore(newItem, cartItems.firstChild);
            });
            
            // Re-crear iconos
            lucide.createIcons();

            document.getElementById('empanada-number').innerText = cart.length + 1;
            
            if (cart.length === 0) {
                document.getElementById('mini-cart').classList.add('hidden');
                document.getElementById('payment-section').classList.add('hidden');
            }
            
            updateFooter();
        }

        function resetBuilder() {
            currentIngredients = [];
            document.querySelectorAll('.card-ingredient').forEach(el => el.classList.remove('selected'));
        }

        function updateFooter() {
            const subtotal = cart.length * 5000;
            const delivery = 4000;
            const total = subtotal + delivery;

            document.getElementById('count-footer').innerText = cart.length;
            document.getElementById('subtotal-footer').innerText = `$${subtotal.toLocaleString()}`;
            document.getElementById('total-footer').innerText = `$${total.toLocaleString()}`;
        }

        // --- ENVIAR A WHATSAPP ---
        function finishOrder() {
            const name = document.getElementById('clientName').value.trim();
            const address = document.getElementById('clientAddress').value.trim();

            if (!name || !address) {
                alert("丘멆잺 춰Faltan tus datos arriba (Nombre y Direcci칩n)!");
                window.scrollTo(0,0);
                return;
            }

            if (cart.length === 0) {
                alert("丘멆잺 춰No has armado ninguna empanada! Agrega al menos una.");
                return;
            }

            if (!selectedPayment) {
                alert("丘멆잺 Por favor selecciona un Medio de Pago (al final de la p치gina).");
                window.scrollTo(0, document.body.scrollHeight);
                return;
            }

            let msg = `游댠 *NUEVO PEDIDO RELLENAS* 游댠\n`;
            msg += `游녻 *Cliente:* ${name}\n`;
            msg += `游늸 *Ubicaci칩n:* ${address}\n`;
            msg += `游눱 *Pago:* ${selectedPayment}\n\n`;
            
            msg += `游 *DETALLE (${cart.length} Empanadas):*\n`;
            
            cart.forEach((ingredients, i) => {
                msg += `\n*#${i+1}:* `;
                if(ingredients.length === 0) msg += `Solo Masa`;
                else msg += ingredients.join(' + ');
            });
            
            msg += `\n\n--------------------------------\n`;
            msg += `游 Subtotal: $${(cart.length * 5000).toLocaleString()}\n`;
            msg += `游띳 Domicilio: $4.000\n`;
            msg += `游눯 *TOTAL A PAGAR: $${((cart.length * 5000) + 4000).toLocaleString()}*\n`;

            const phone = "573003688109";
            window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // --- INICIALIZAR ---
        renderGrid(salados, 'content-sal');
        renderGrid(dulces, 'content-dulce');
        renderGrid(quesos, 'content-quesos');
        lucide.createIcons();
    </script>
</body>
</html>


