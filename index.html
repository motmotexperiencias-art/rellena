<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReLlenas - Barichara</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #FAFAFA;
            color: #111111;
            padding-bottom: 180px; /* Espacio extra para el footer grande */
        }

        /* PALETA FAST FOOD */
        :root {
            --hunger-yellow: #FFC300; /* Amarillo Queso/Mostaza */
            --hunger-red: #D32F2F;    /* Rojo Salsa/Urgencia */
            --hunger-black: #111111;
        }

        .text-yellow-brand { color: var(--hunger-yellow); }
        .text-red-brand { color: var(--hunger-red); }
        .bg-red-brand { background-color: var(--hunger-red); }

        /* T√≠tulos */
        .section-title {
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
            z-index: 1;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 0;
            width: 100%;
            height: 10px;
            background-color: var(--hunger-yellow);
            z-index: -1;
            opacity: 0.5;
            transform: skewX(-10deg);
        }
        
        /* TARJETAS */
        .card-ingredient {
            background-color: #ffffff;
            border: 2px solid #E5E7EB;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Estado Seleccionado */
        .card-ingredient.selected {
            background-color: #FFF9C4;
            border-color: var(--hunger-black);
            box-shadow: 4px 4px 0px var(--hunger-black);
            transform: translate(-2px, -2px);
        }
        .card-ingredient.selected .check-indicator {
            background-color: var(--hunger-red); /* Check Rojo */
            color: white;
            border-color: var(--hunger-red);
        }

        /* Check Indicator Base */
        .check-indicator {
            background-color: #F3F4F6;
            color: transparent;
            border: 1px solid #D1D5DB;
        }

        /* INPUTS */
        .input-light {
            background-color: #ffffff;
            border: 2px solid #E5E7EB;
            color: #111;
            transition: all 0.2s;
        }
        .input-light:focus {
            border-color: var(--hunger-red); /* Foco Rojo */
            outline: none;
            box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
        }

        /* BOTONES */
        .btn-add {
            background-color: #111;
            color: var(--hunger-yellow);
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .btn-order {
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            color: white;
            border: none;
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.3);
        }
        .btn-order:active {
            transform: scale(0.98);
        }

        /* SALSAS (Botones) */
        .btn-salsa.selected {
            background-color: var(--hunger-red);
            color: white;
            border-color: var(--hunger-red);
        }

        /* MEDIOS DE PAGO */
        .payment-option {
            border: 2px solid #E5E7EB;
            transition: all 0.2s;
        }
        .payment-option.selected {
            border-color: var(--hunger-red);
            background-color: #FEF2F2;
            color: var(--hunger-red);
            font-weight: bold;
        }
        
        /* CARRITO */
        .cart-item {
            border-left: 4px solid var(--hunger-red);
        }
    </style>
</head>
<body>

    <!-- Header Fijo -->
    <header class="fixed top-0 w-full z-50 bg-white/95 backdrop-blur-md border-b border-gray-100 p-4 shadow-sm">
        <div class="flex justify-between items-center max-w-md mx-auto">
            <!-- Logo y Ubicaci√≥n -->
            <div class="flex flex-col leading-none">
                <h1 class="text-3xl font-black italic tracking-tighter text-black">
                    Re<span class="text-yellow-brand">Llenas</span>
                </h1>
                <div class="flex items-center gap-1 mt-1">
                    <i data-lucide="map-pin" class="w-3 h-3 text-red-brand"></i>
                    <span class="text-[10px] text-gray-500 font-bold uppercase tracking-widest">Barichara ¬∑ Parque</span>
                </div>
            </div>
            <!-- Precio -->
            <div class="text-right">
                <div class="bg-red-brand text-white text-[10px] font-bold px-2 py-0.5 rounded-sm inline-block mb-1 transform -rotate-2">PRECIO √öNICO</div>
                <div class="text-2xl font-black text-black leading-none">$5.000</div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-md mx-auto pt-28 px-4">
        
        <!-- Info Domicilio -->
        <section class="mb-4 bg-yellow-50 p-4 rounded-xl border border-yellow-200">
            <div class="flex items-start gap-3">
                <div class="bg-yellow-400 p-2 rounded-full text-black">
                    <i data-lucide="bike" class="w-5 h-5"></i>
                </div>
                <div>
                    <h3 class="text-sm font-bold text-black uppercase">Domicilio: $4.000</h3>
                    <p class="text-xs text-gray-600 leading-tight mt-1">
                        Tarifa v√°lida para casco urbano Barichara. 
                        <span class="text-red-brand font-bold block mt-1">‚ö† Veredas tienen costo adicional.</span>
                    </p>
                </div>
            </div>
        </section>

        <!-- Formulario Datos (Solo se llena una vez) -->
        <section class="mb-6">
            <div class="grid gap-3">
                <input type="text" id="clientName" placeholder="¬øC√≥mo te llamas?" class="input-light w-full rounded-lg p-3 placeholder-gray-400 font-semibold">
                <input type="text" id="clientAddress" placeholder="Direcci√≥n / Barrio / Hotel" class="input-light w-full rounded-lg p-3 placeholder-gray-400 font-semibold">
            </div>
        </section>

        <!-- AVISO DE CANTIDAD -->
        <section class="mb-8 bg-black p-4 rounded-xl shadow-lg border-l-4 border-yellow-400">
            <div class="flex items-center gap-2 mb-1">
                <i data-lucide="pie-chart" class="text-yellow-400 w-5 h-5"></i>
                <h3 class="text-white font-bold text-sm uppercase">Sobre el Relleno</h3>
            </div>
            <p class="text-gray-300 text-xs leading-relaxed">
                La empanada tiene un tama√±o fijo. Si pides muchos ingredientes, la cantidad total <strong>se divide equitativamente</strong> entre todos.
                <br>
                <em class="text-gray-400 mt-1 block">¬°T√∫ decides la mezcla!</em>
            </p>
        </section>

        <!-- ZONA DE ARMADO -->
        <div id="builder-zone" class="transition-all duration-300">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-black text-red-700 uppercase border-b-2 border-red-700 inline-block">Armando Empanada #<span id="empanada-counter">1</span></h2>
                <button onclick="resetBuilder()" class="text-xs text-gray-400 underline">Borrar selecci√≥n</button>
            </div>

            <!-- MUNDO SAL -->
            <section class="mb-8">
                <h3 class="text-sm font-bold text-gray-500 mb-2 uppercase tracking-wide">Mundo Sal</h3>
                <div id="content-sal" class="grid grid-cols-2 gap-3"></div>
            </section>

            <!-- MUNDO DULCE -->
            <section class="mb-8">
                <h3 class="text-sm font-bold text-gray-500 mb-2 uppercase tracking-wide">Mundo Dulce</h3>
                <div id="content-dulce" class="grid grid-cols-2 gap-3"></div>
            </section>

            <!-- SALSAS -->
            <section class="mb-6 border-t border-dashed border-gray-200 pt-4">
                <h3 class="text-sm font-bold text-black mb-3 flex items-center gap-2">
                    <i data-lucide="flame" class="text-red-brand w-4 h-4 fill-current"></i> Salsas (Gratis)
                </h3>
                <div class="grid grid-cols-2 gap-2" id="salsasContainer"></div>
            </section>

            <!-- Notas -->
            <div class="mb-6">
                <textarea id="notes" placeholder="Nota para esta empanada (Ej: Doble queso, sin servilleta...)" class="input-light w-full rounded-lg p-3 text-sm h-16 resize-none font-medium"></textarea>
            </div>

            <!-- BOT√ìN AGREGAR -->
            <button onclick="addEmpanadaToCart()" class="btn-add w-full py-3 rounded-xl font-black text-lg flex items-center justify-center gap-2 uppercase tracking-wide mb-8">
                <i data-lucide="plus-circle" class="w-6 h-6"></i>
                Agregar otra empanada
            </button>
        </div>

        <!-- RESUMEN DEL PEDIDO (CARRITO) -->
        <section id="cart-section" class="mb-8 hidden">
            <h2 class="text-2xl font-black text-black section-title">TU PEDIDO</h2>
            <div id="cart-container" class="space-y-3 mb-6">
                <!-- Aqu√≠ se agregan las empanadas -->
            </div>
            
            <!-- MEDIOS DE PAGO -->
            <div class="bg-white p-4 rounded-xl border border-gray-200">
                <h3 class="text-sm font-bold text-black mb-3 uppercase">¬øC√≥mo vas a pagar?</h3>
                <div class="grid grid-cols-2 gap-2">
                    <div onclick="selectPayment('Nequi', this)" class="payment-option p-3 rounded-lg text-center cursor-pointer text-xs font-bold text-gray-500">Nequi</div>
                    <div onclick="selectPayment('Daviplata', this)" class="payment-option p-3 rounded-lg text-center cursor-pointer text-xs font-bold text-gray-500">Daviplata</div>
                    <div onclick="selectPayment('Efectivo', this)" class="payment-option p-3 rounded-lg text-center cursor-pointer text-xs font-bold text-gray-500">Efectivo</div>
                    <div onclick="selectPayment('Tarjeta', this)" class="payment-option p-3 rounded-lg text-center cursor-pointer text-xs font-bold text-gray-500">Tarjeta</div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer Sticky -->
    <footer class="fixed bottom-0 w-full bg-white border-t border-gray-100 p-4 z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.05)]">
        <div class="max-w-md mx-auto">
            <!-- Desglose de Precios -->
            <div class="flex justify-between items-end mb-3 text-xs border-b border-gray-100 pb-2">
                <div class="text-gray-500">
                    <p>Empanadas (<span id="count-empanadas">0</span>): <span class="font-bold text-black" id="price-empanadas">$0</span></p>
                    <p>Domicilio: <span class="font-bold text-black">$4.000</span></p>
                </div>
                <div class="text-right">
                    <p class="font-black text-2xl text-black" id="total-price">$4.000</p>
                </div>
            </div>

            <!-- Bot√≥n Acci√≥n -->
            <button onclick="sendOrder()" class="btn-order w-full py-4 rounded-xl font-black text-xl flex items-center justify-center gap-3 transform transition-transform uppercase tracking-wider">
                <span>ENVIAR PEDIDO</span>
                <i data-lucide="message-circle" class="w-6 h-6"></i>
            </button>
        </div>
    </footer>

    <script>
        // DATOS
        const ingredientsSal = [
            { id: 'carne', name: 'Carne', desc: 'Desmechada / Molida' },
            { id: 'pollo', name: 'Pollo', desc: 'Desmechado' },
            { id: 'chorizo', name: 'Chorizo', desc: 'Santandereano' },
            { id: 'queso_sal', name: 'Queso Salado', desc: 'Coste√±o / Doble Crema' },
            { id: 'maiz', name: 'Ma√≠z', desc: 'Tiernito' },
            { id: 'arroz', name: 'Arroz', desc: 'Blanco suelto' },
            { id: 'papa', name: 'Papa', desc: 'Picada / Fosforito' },
            { id: 'huevo', name: 'Huevo', desc: 'Cocido picado' }
        ];

        const ingredientsDulce = [
            { id: 'alpina', name: 'Arequipe Alpina', desc: 'El original' },
            { id: 'jumbo', name: 'Choco Jumbo', desc: '1 Chocolatina Personal (17g)' },
            { id: 'nutella', name: 'Nutella', desc: 'Crema de avellanas' },
            { id: 'queso_dul', name: 'Queso Doble Crema', desc: 'Para fundir' },
            { id: 'almendras', name: 'Almendras', desc: 'Laminadas' },
            { id: 'mani', name: 'Man√≠', desc: 'Triturado' },
            { id: 'mora', name: 'Mermelada Mora', desc: 'Dulce de fruta' },
            { id: 'pina', name: 'Mermelada Pi√±a', desc: 'Calada' },
            { id: 'maracuya', name: 'Mermelada Maracuy√°', desc: '√Åcida y dulce' }
        ];

        const salsas = [
            { id: 'aji', name: 'Aj√≠ Casero' },
            { id: 'lecherita', name: 'Lecherita' },
            { id: 'tartara', name: 'Salsa T√°rtara' },
            { id: 'pina_salsa', name: 'Salsa de Pi√±a' }
        ];

        // ESTADO GLOBAL
        let cart = []; // Aqu√≠ guardamos las empanadas ya listas
        let currentSelection = []; // Ingredientes actuales
        let currentSalsas = []; // Salsas actuales
        let selectedPayment = null;

        // RENDERIZADO
        function renderList(items, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card-ingredient p-4 rounded-xl cursor-pointer group flex flex-col justify-between h-24';
                card.onclick = () => toggleItem(item.name, card);
                card.id = `card-${item.name.replace(/\s/g, '')}`; // ID para resetear
                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h4 class="font-black text-black text-lg leading-none group-hover:text-red-700 transition-colors">${item.name}</h4>
                        <div class="check-indicator w-6 h-6 rounded-full flex items-center justify-center border transition-all">
                            <i data-lucide="check" class="w-4 h-4 font-bold"></i>
                        </div>
                    </div>
                    <p class="text-[11px] text-gray-500 font-bold uppercase tracking-wide mt-auto">${item.desc}</p>
                `;
                container.appendChild(card);
            });
        }

        function renderSalsas() {
            const container = document.getElementById('salsasContainer');
            container.innerHTML = '';
            salsas.forEach(salsa => {
                const btn = document.createElement('div');
                btn.className = 'btn-salsa p-3 rounded-lg border-2 border-gray-100 bg-white text-gray-400 text-sm font-bold text-center cursor-pointer hover:border-red-400 transition-colors select-none';
                btn.innerText = salsa.name;
                btn.id = `salsa-${salsa.name.replace(/\s/g, '')}`;
                btn.onclick = function() {
                    if (currentSalsas.includes(salsa.name)) {
                        currentSalsas = currentSalsas.filter(s => s !== salsa.name);
                        this.classList.remove('selected');
                        this.classList.add('bg-white', 'text-gray-400', 'border-gray-100');
                    } else {
                        currentSalsas.push(salsa.name);
                        this.classList.remove('bg-white', 'text-gray-400', 'border-gray-100');
                        this.classList.add('selected');
                    }
                };
                container.appendChild(btn);
            });
        }

        // L√ìGICA DE SELECCI√ìN
        function toggleItem(name, element) {
            if (currentSelection.includes(name)) {
                currentSelection = currentSelection.filter(i => i !== name);
                element.classList.remove('selected');
            } else {
                currentSelection.push(name);
                element.classList.add('selected');
            }
        }

        function selectPayment(method, element) {
            selectedPayment = method;
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
        }

        // L√ìGICA DEL CARRITO
        function addEmpanadaToCart() {
            // Validar que haya ingredientes
            if (currentSelection.length === 0) {
                if(!confirm("¬øSeguro quieres agregar una empanada VAC√çA (Solo Masa)?")) return;
            }

            const notes = document.getElementById('notes').value.trim();

            const empanada = {
                id: cart.length + 1,
                ingredients: [...currentSelection],
                salsas: [...currentSalsas],
                notes: notes
            };

            cart.push(empanada);
            
            // UI Updates
            renderCart();
            resetBuilder();
            updateTotal();
            
            // Scroll al carrito
            document.getElementById('cart-section').classList.remove('hidden');
            document.getElementById('cart-section').scrollIntoView({ behavior: 'smooth' });
        }

        function renderCart() {
            const container = document.getElementById('cart-container');
            container.innerHTML = '';
            
            cart.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'cart-item bg-white p-4 rounded-lg shadow-sm border border-gray-100 relative';
                
                let contentHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-black text-lg">Empanada #${index + 1}</h4>
                        <span class="text-sm font-bold text-gray-500">$5.000</span>
                    </div>
                    <div class="text-sm text-gray-700 mb-2">
                        ${item.ingredients.length > 0 ? item.ingredients.join(' + ') : 'Solo Masa'}
                    </div>
                `;

                if(item.salsas.length > 0) {
                    contentHTML += `<div class="text-xs text-red-500 font-bold mb-1">Salsas: ${item.salsas.join(', ')}</div>`;
                }
                
                if(item.notes) {
                    contentHTML += `<div class="text-xs text-gray-400 italic">Nota: "${item.notes}"</div>`;
                }

                // Bot√≥n eliminar (opcional, simple)
                contentHTML += `<button onclick="removeEmpanada(${index})" class="absolute top-2 right-2 text-xs text-red-300 font-bold px-2 py-1">X</button>`;

                div.innerHTML = contentHTML;
                container.appendChild(div);
            });

            // Actualizar contador del t√≠tulo
            document.getElementById('empanada-counter').innerText = cart.length + 1;
        }

        function removeEmpanada(index) {
            cart.splice(index, 1);
            renderCart();
            updateTotal();
            if(cart.length === 0) {
                document.getElementById('cart-section').classList.add('hidden');
                document.getElementById('empanada-counter').innerText = 1;
            }
        }

        function resetBuilder() {
            currentSelection = [];
            currentSalsas = [];
            document.getElementById('notes').value = '';
            
            // Limpiar UI visualmente
            document.querySelectorAll('.card-ingredient').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.btn-salsa').forEach(el => {
                el.classList.remove('selected');
                el.classList.add('bg-white', 'text-gray-400', 'border-gray-100');
            });
            
            // Scroll arriba para armar la siguiente
            document.getElementById('builder-zone').scrollIntoView({ behavior: 'smooth' });
        }

        function updateTotal() {
            const priceEmpanadas = cart.length * 5000;
            const priceDelivery = 4000;
            const total = priceEmpanadas + priceDelivery;

            document.getElementById('count-empanadas').innerText = cart.length;
            document.getElementById('price-empanadas').innerText = `$${priceEmpanadas.toLocaleString()}`;
            document.getElementById('total-price').innerText = `$${total.toLocaleString()}`;
        }

        // ENVIAR PEDIDO FINAL
        function sendOrder() {
            const name = document.getElementById('clientName').value.trim();
            const address = document.getElementById('clientAddress').value.trim();

            if (!name || !address) {
                alert("‚ö†Ô∏è ¬°Falta tu Nombre y Direcci√≥n!");
                document.getElementById('clientName').focus();
                window.scrollTo(0,0);
                return;
            }

            if (cart.length === 0) {
                alert("‚ö†Ô∏è ¬°El carrito est√° vac√≠o! Arma al menos una empanada.");
                return;
            }

            if (!selectedPayment) {
                alert("‚ö†Ô∏è Por favor selecciona un Medio de Pago (al final del pedido).");
                document.getElementById('cart-section').scrollIntoView();
                return;
            }

            const total = (cart.length * 5000) + 4000;

            let msg = `üî• *NUEVO PEDIDO BARICHARA* üî•\n`;
            msg += `üë§ *Cliente:* ${name}\n`;
            msg += `üìç *Ubicaci√≥n:* ${address}\n`;
            msg += `üí≥ *Pago:* ${selectedPayment}\n\n`;
            
            msg += `ü•ü *PEDIDO (${cart.length} Empanadas):*\n`;
            
            cart.forEach((item, i) => {
                msg += `\n*#${i+1} EMPANADA:* \n`;
                if(item.ingredients.length === 0) msg += `‚õî Solo Masa\n`;
                else item.ingredients.forEach(ing => msg += `‚úÖ ${ing}\n`);
                
                if(item.salsas.length > 0) msg += `üç∂ Salsas: ${item.salsas.join(', ')}\n`;
                if(item.notes) msg += `üìù Nota: ${item.notes}\n`;
            });
            
            msg += `\n--------------------------------\n`;
            msg += `ü•ü Subtotal: $${(cart.length * 5000).toLocaleString()}\n`;
            msg += `üõµ Domicilio: $4.000\n`;
            msg += `üí∞ *TOTAL A PAGAR: $${total.toLocaleString()}*\n`;
            
            const phone = "573003688109";
            window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // INIT
        renderList(ingredientsSal, 'content-sal');
        renderList(ingredientsDulce, 'content-dulce');
        renderSalsas();
        lucide.createIcons();
    </script>
</body>
</html>


